# Movies App - Страницы приложения

Документ описывает структуру страниц фронтенд-приложения, элементы на страницах и навигацию между ними.

> **Mobile-first:** Приложение разрабатывается с приоритетом на мобильные устройства. Основная навигация — нижний таб-бар.

---

## Обзор структуры

```
/                                       → Landing (публичный)
├── /login                              → Вход
├── /register                           → Регистрация
│
├── (tabs)                              → Авторизованная зона с Bottom Nav
│   ├── /groups                         → Список групп (таб "Группы")
│   │   └── /groups/new                 → Создание группы (modal)
│   │
│   ├── /groups/[id]                    → Страница группы
│   │   ├── /groups/[id]/movies/search  → Поиск фильмов (modal)
│   │   └── /groups/[id]/settings       → Настройки группы
│   │
│   ├── /profile                        → Профиль (таб "Профиль")
│   │   └── /profile/settings           → Настройки профиля
│   │
│   └── /admin                          → Админ-панель (таб "Админ", только ADMIN)
│       ├── /admin/users                → Управление пользователями
│       ├── /admin/movies               → Управление базой фильмов
│       └── /admin/groups               → Управление всеми группами
```

---

## Навигация

### Bottom Navigation Bar (авторизованные)

Нижний навбар отображается на всех страницах авторизованной зоны. Фиксирован внизу экрана.

```
┌────────────────────────────────┐
│                                │
│            [Content]           │
│                                │
├──────────┬──────────┬──────────┤
│    🏠    │     👤   │     ⚙️   │  ← ADMIN
│  Группы  │  Профиль │   Админ  │
├──────────┼──────────┼──────────┤
│    🏠    │     👤   │          │  ← USER
│  Группы  │  Профиль │          │
└──────────┴──────────┴──────────┘
```

| Таб | Icon | LABEL | Роли | Роут |
| --- | ---- | ----- | ---- | ---- |
| Группы | home | Группы | USER, ADMIN | /groups |
| Профиль | user | Профиль | USER, ADMIN | /profile |
| Админ | settings | Админ | ADMIN only | /admin |

**Поведение:**
- Активный таб подсвечивается цветом
- Таб "Админ" виден только пользователям с ролью ADMIN
- На вложенных страницах (группа, настройки) навбар остаётся видимым
- На модальных окнах (fullscreen) навбар скрыт

### Верхняя панель (Top Bar)

Минимальная верхняя панель появляется только на вложенных страницах для навигации назад:

```
┌─────────────────────────────────────────┐
│  ←   Название страницы                  │
└─────────────────────────────────────────┘
```

**Элементы:**
- Кнопка "Назад" (←) — возвращает на предыдущую страницу
- Заголовок страницы (опционально)

### Жесты

| Жест | Действие |
| ---- | -------- |
| Swipe right (от левого края) | Назад (на Android-like навигации) |
| Pull down | Обновление страницы (pull-to-refresh) |
| Long press на карточке | Контекстное меню (действия) |

---

## Публичные страницы (без навбара)

### 1. Landing (`/`)

**Доступ:** Публичный

**Описание:** Главная страница-приветствие. Минималистичный дизайн, фокус на CTA.

**Layout:** Fullscreen, centered content

**Элементы:**
- Логотип приложения (крупный, по центру)
- Краткое описание (1-2 строки)
- Кнопка "Начать" (primary, full width) → /register
- Кнопка "Войти" (secondary, text link) → /login

**Переходы:**
- → /register (кнопка "Начать")
- → /login (кнопка "Уже есть аккаунт? Войти")
- → /groups (авторедирект если уже залогинен)

---

### 2. Login (`/login`)

**Доступ:** Публичный (только для неавторизованных)

**Layout:** Fullscreen form, keyboard-aware

**Элементы:**
- Кнопка "Назад" (←) → /
- Заголовок "Вход"
- Поле Email (с иконкой, type="email")
- Поле Пароль (с toggle видимости)
- Кнопка "Войти" (full width, primary)
- Ссылка "Нет аккаунта? Зарегистрироваться"

**API:** `POST /api/v1/auth/login`

**Переходы:**
- → /groups (после успешного входа)
- → /register (ссылка)
- → / (кнопка "Назад")

**Валидация:**
- Email: обязателен, валидный формат
- Пароль: обязателен

---

### 3. Register (`/register`)

**Доступ:** Публичный (только для неавторизованных)

**Layout:** Fullscreen form, scrollable при появлении клавиатуры

**Элементы:**
- Кнопка "Назад" (←) → /
- Заголовок "Регистрация"
- Поле Имя
- Поле Email
- Поле Пароль (с индикатором сложности)
- Поле Подтверждение пароля
- Кнопка "Зарегистрироваться" (full width, primary)
- Ссылка "Уже есть аккаунт? Войти"

**API:** `POST /api/v1/auth/register`

**Переходы:**
- → /groups (после успешной регистрации)
- → /login (ссылка)
- → / (кнопка "Назад")

**Валидация:**
- Имя: 2-256 символов
- Email: валидный формат
- Пароль: минимум 8 символов
- Пароли должны совпадать

---

## Авторизованные страницы (с Bottom Nav)

### 4. Groups List (`/groups`)

**Доступ:** Авторизованные пользователи

**Описание:** Главная страница после входа. Список групп пользователя.

**Layout:**
```
┌─────────────────────────────────────────┐
│  Мои группы                         [+] │  ← Header
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐    │
│  │ ┌──────┐ Название группы        │    │  ← Card
│  │ │ Фото │ Описание...            │    │
│  │ └──────┘ 👥12  🎬45     [admin] │    │
│  └─────────────────────────────────┘    │
│                                         │
│  ┌─────────────────────────────────┐    │
│  │ ...                             │    │
│  └─────────────────────────────────┘    │
│                                         │
├──────────┬─────────────┬────────────────┤
│  Группы  │   Профиль   │      Админ     │  ← Bottom Nav
└──────────┴─────────────┴────────────────┘
```

**Элементы:**
- Header с заголовком "Мои группы" и кнопкой "+" (создать)
- Карточки групп (vertical list):
  - Аватар (слева, 48x48)
  - Название группы
  - Описание (1 строка, обрезанное)
  - Мета-информация: участники, фильмы, role badge
- Empty state: иллюстрация + текст "Создайте первую группу"
- Pull-to-refresh

**API:** `GET /api/v1/groups`

**Переходы:**
- → /groups/[id] (tap на карточку)
- → /groups/new (кнопка "+")

---

### 5. Create Group (`/groups/new`)

**Доступ:** Авторизованные пользователи

**Описание:** Создание новой группы. Открывается как модальное окно (bottom sheet или fullscreen).

**Layout:** Fullscreen modal с кнопкой закрытия

**Элементы:**
- Header: "← Создать группу" или "×" (закрыть)
- Аватар группы (круглый placeholder + иконка камеры)
- Поле "Название" (required)
- Поле "Описание" (textarea, optional)
- Кнопка "Создать" (fixed bottom, primary)

**API:** `POST /api/v1/groups`

**Переходы:**
- → /groups/[id] (после создания)
- → /groups (отмена/закрытие)

---

### 6. Group Page (`/groups/[groupId]`)

**Доступ:** Участники группы

**Описание:** Страница группы со списком фильмов. Основной экран работы с группой.

**Layout:**
```
┌─────────────────────────────────────────┐
│  ←  Название группы             ⚙️      │  ← Header
├─────────────────────────────────────────┤
│         [Аватар группы - крупный]       │
│              Название                   │
│           Описание группы               │
│        👥 12 участников • admin         │
├─────────────────────────────────────────┤
│ [Все] [К просмотру] [План] [Смотрели]   │  ← Tabs
├─────────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐    │
│  │ Постер  │ │ Постер  │ │ Постер  │    │  ← Grid 2-3 колонки
│  │ Название│ │ Название│ │ Название│    │
│  │ 2024    │ │ 2023    │ │ 2024    │    │
│  └─────────┘ └─────────┘ └─────────┘    │
│                                         │
│                    [+]                  │  ← FAB (moderator+)
├──────────┬─────────────┬────────────────┤
│  Группы  │   Профиль   │      Админ     │  ← Bottom Nav
└──────────┴─────────────┴────────────────┘
```

**Элементы:**

*Header:*
- Кнопка "Назад" → /groups
- Название группы (обрезается если длинное)
- Кнопка "Настройки" (gear icon) → /groups/[id]/settings

*Информация о группе:*
- Аватар (крупный, по центру)
- Название
- Описание (опционально, можно свернуть)
- Количество участников + role badge текущего юзера

*Фильтр-табы (горизонтальный scroll):*
- "Все" — все фильмы
- "К просмотру" — tracking
- "План" — planned
- "Смотрели" — watched

*Список фильмов:*
- Grid 2-3 колонки (адаптивно)
- Карточка фильма: постер, название, год, статус badge
- Pull-to-refresh

*FAB (Floating Action Button):*
- Иконка "+"
- Позиция: bottom-right, выше навбара
- Виден только moderator+
- → /groups/[id]/movies/search

**API:**
- `GET /api/v1/groups/:id`
- `GET /api/v1/groups/:id/movies`
- `GET /api/v1/groups/:id/custom-movies`

**Переходы:**
- → /groups (назад)
- → /groups/[id]/settings (gear icon)
- → /groups/[id]/movies/search (FAB, moderator+)
- → /groups/[id]/movies/[movieId] (tap на карточку фильма)

---

### 7. Movie Search (`/groups/[groupId]/movies/search`)

**Доступ:** Участники группы

**Описание:** Поиск фильмов для добавления в группу. Открывается как fullscreen modal.

**Layout:**
```
┌─────────────────────────────────────────┐
│  ×  Добавить фильм                      │  ← Header
├─────────────────────────────────────────┤
│ [🔍 Поиск фильмов...              ]     │  ← Search input
├─────────────────────────────────────────┤
│                                         │
│  Kinopoisk                              │
│  ┌─────────────────────────────────┐    │
│  │ [Постер] Матрица      [Добавить]│    │
│  │          1999 • 8.7             │    │
│  └─────────────────────────────────┘    │
│                                         │
│  Уже в группе                           │
│  ┌─────────────────────────────────┐    │
│  │ [Постер] Начало      ✓ В группе │    │
│  │          2010 • 8.8             │    │
│  └─────────────────────────────────┘    │
│                                         │
├─────────────────────────────────────────┤
│  Создать свой фильм                     │  ← Кнопка (moderator+)
└─────────────────────────────────────────┘
```

**Элементы:**
- Header с кнопкой закрытия (×)
- Search input (sticky top, autofocus)
- Результаты поиска (после ввода 3+ символов):
  - Секция "Kinopoisk" — результаты из API
  - Секция "Уже в группе" — существующие custom фильмы
- Карточки фильмов (list layout):
  - Постер (маленький, слева)
  - Название, год, рейтинг
  - Кнопка "Добавить" (moderator+) или "✓ В группе"
- Кнопка "Создать свой фильм" (fixed bottom, moderator+)
- Loading skeleton при поиске

**API:** `GET /api/v1/groups/:id/movies/search?query=...`

**Переходы:**
- → /groups/[id] (закрытие модала или после добавления)
- → /groups/[id]/custom-movies/new (кнопка "Создать свой фильм")

---

### 8. Group Settings (`/groups/[groupId]/settings`)

**Доступ:** Модераторы и админы группы

**Описание:** Управление настройками группы и участниками.

**Layout:**
```
┌─────────────────────────────────────────┐
│  ←  Настройки группы                    │
├─────────────────────────────────────────┤
│                                         │
│  Основные                               │
│  ┌─────────────────────────────────┐    │
│  │ Аватар          [📷]            │    │
│  │ Название        [input]         │    │
│  │ Описание        [textarea]      │    │
│  └─────────────────────────────────┘    │
│                                         │
│  Участники (12)                    [+]  │
│  ┌─────────────────────────────────┐    │
│  │ [👤] Иван П.      admin    [⋮]  │    │
│  │ [👤] Мария С.     moderator [⋮] │    │
│  │ [👤] Алексей К.   member   [⋮]  │    │
│  └─────────────────────────────────┘    │
│                                         │
│  ───────────────────────────────────    │
│                                         │
│  [🚪 Выйти из группы]                   │
│  [🗑️ Удалить группу]   (admin only)     │
│                                         │
├─────────┬─────────────┬─────────────────┤
│  Группы │   Профиль   │     Админ       │
└─────────┴─────────────┴─────────────────┘
```

**Элементы:**

*Основные настройки:*
- Аватар (tap → upload)
- Название (input)
- Описание (textarea)
- Кнопка "Сохранить" (появляется при изменениях)

*Участники:*
- Заголовок + счётчик + кнопка "+"
- Список участников (list):
  - Аватар, имя
  - Role badge
  - Меню действий [...] (для admin):
    - Изменить роль
    - Удалить из группы
    - Передать владение (для owner)

*Опасная зона:*
- "Выйти из группы" (member/moderator)
- "Удалить группу" (admin only, destructive color)
- Подтверждение через modal/bottom sheet

**API:**
- `PATCH /api/v1/groups/:id`
- `GET /api/v1/groups/:id/members`
- `POST /api/v1/groups/:id/members`
- `PATCH /api/v1/groups/:id/members/:userId`
- `DELETE /api/v1/groups/:id/members/:userId`
- `DELETE /api/v1/groups/:id/members/me`
- `POST /api/v1/groups/:id/transfer-ownership`
- `DELETE /api/v1/groups/:id`

**Переходы:**
- → /groups/[id] (после сохранения или назад)
- → /groups (после выхода/удаления)

---

### 9. Profile (`/profile`)

**Доступ:** Авторизованные пользователи

**Описание:** Профиль текущего пользователя.

**Layout:**
```
┌─────────────────────────────────────────┐
│  Профиль                           [⚙️] │  ← Header
├─────────────────────────────────────────┤
│                                         │
│            [👤 Аватар]                  │
│             Иван Петров                 │
│          ivan@example.com               │
│              USER                       │  ← Badge
│                                         │
│  ┌─────────────┐ ┌─────────────┐        │
│  │     5       │ │     42      │        │  ← Stats
│  │   Групп     │ │  Просмотрено│        │
│  └─────────────┘ └─────────────┘        │
│                                         │
│  ───────────────────────────────────    │
│                                         │
│  🚪 Выйти из аккаунта                   │
│                                         │
├─────────┬─────────────┬─────────────────┤
│  Группы │   Профиль   │     Админ       │
└─────────┴─────────────┴─────────────────┘
```

**Элементы:**
- Аватар (крупный, по центру)
- Имя пользователя
- Email
- Role badge (USER/ADMIN)
- Статистика: группы, просмотренные фильмы
- Кнопка "Настройки" (gear icon) → /profile/settings
- Кнопка "Выйти из аккаунта"

**API:** `GET /api/v1/users/me`

**Переходы:**
- → /profile/settings (⚙️)
- → / (после выхода)

---

### 10. Profile Settings (`/profile/settings`)

**Доступ:** Авторизованные пользователи

**Описание:** Редактирование профиля.

**Layout:** Form page с сохранением

**Элементы:**
- Header: "← Настройки профиля"
- Аватар (tap → upload)
- Имя (input)
- Email (input)
- Секция "Сменить пароль" (expandable):
  - Текущий пароль
  - Новый пароль
  - Подтверждение
- Кнопка "Сохранить" (fixed bottom)
- Секция "Удалить аккаунт" (destructive, с подтверждением)

**API:**
- `PATCH /api/v1/users/:id`
- `DELETE /api/v1/users/:id`

**Переходы:**
- → /profile (после сохранения или назад)
- → / (после удаления аккаунта)

---

## Админ-панель

### 11. Admin Panel (`/admin`)

**Доступ:** Только ADMIN

**Описание:** Главная страница админки с быстрой статистикой и навигацией.

**Layout:**
```
┌────────────────────────────────────────┐
│  Админ-панель                          │
├────────────────────────────────────────┤
│  ┌───────────┐ ┌───────────┐           │
│  │   156     │ │    23     │           │
│  │ Пользоват.│ │  Группы   │           │
│  └───────────┘ └───────────┘           │
│  ┌───────────┐                         │
│  │   1247    │                         │
│  │  Фильмов  │                         │
│  └───────────┘                         │
├────────────────────────────────────────┤
│                                        │
│  👥 Пользователи                   →   │
│  ─────────────────────────────────     │
│  🎬 Фильмы                         →   │
│  ─────────────────────────────────     │
│  📁 Группы                         →   │
│                                        │
├─────────┬─────────────┬────────────────┤
│  Группы │   Профиль   │     Админ      │
└─────────┴─────────────┴────────────────┘
```

**Элементы:**
- Статистика (карточки в ряд):
  - Пользователи
  - Группы
  - Фильмы в базе
- Меню навигации (list с иконками):
  - Пользователи → /admin/users
  - Фильмы → /admin/movies
  - Группы → /admin/groups

**Переходы:**
- → /admin/users
- → /admin/movies
- → /admin/groups

---

### 12. Admin Users (`/admin/users`)

**Доступ:** Только ADMIN

**Описание:** Управление пользователями.

**Layout:**
```
┌─────────────────────────────────────────┐
│  ← Пользователи             [+ Добавить]│
├─────────────────────────────────────────┤
│ [🔍 Поиск...                           ]│
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐    │
│  │ [👤] Иван Петров                │    │
│  │      ivan@mail.com    ADMIN [⋮] │    │
│  └─────────────────────────────────┘    │
│  ┌─────────────────────────────────┐    │
│  │ [👤] Мария Сидорова             │    │
│  │      maria@mail.com   USER  [⋮] │    │
│  └─────────────────────────────────┘    │
│                                         │
│  • • •                                  │  ← Pagination
├─────────┬─────────────┬─────────────────┤
│  Группы │   Профиль   │     Админ       │
└─────────┴─────────────┴─────────────────┘
```

**Элементы:**
- Search input (sticky top)
- Список пользователей (cards):
  - Аватар, имя, email
  - Role badge
  - Меню действий [⋮]: edit, change role, delete
- Пагинация (infinite scroll или dots)
- FAB "+ Добавить" (создать пользователя)

**API:**
- `GET /api/v1/users`
- `POST /api/v1/users`
- `PATCH /api/v1/users/:id`
- `DELETE /api/v1/users/:id`

---

### 13. Admin Movies (`/admin/movies`)

**Доступ:** Только ADMIN

**Описание:** Управление базой фильмов.

**Элементы:**
- Search input
- Список фильмов (cards):
  - Постер, название, год, рейтинг
  - IMDb ID, Kinopoisk ID
  - Меню действий: edit, delete
- FAB "+ Добавить" (по IMDb/Kinopoisk ID)
- Пагинация

**API:**
- `GET /api/v1/movies`
- `GET /api/v1/movies/search`
- `POST /api/v1/movies`
- `PATCH /api/v1/movies/:id`
- `DELETE /api/v1/movies/:id`

---

### 14. Admin Groups (`/admin/groups`)

**Доступ:** Только ADMIN

**Описание:** Просмотр всех групп.

**Элементы:**
- Search input
- Список групп (cards):
  - Аватар, название
  - Владелец, количество участников/фильмов
  - Меню действий: view, delete
- Пагинация

**API:** `GET /api/v1/groups/all`

---

## Диаграмма связей

```
                    ┌─────────┐
                    │ Landing │
                    └────┬────┘
                         │
              ┌──────────┴──────────┐
              ▼                     ▼
          ┌───────┐           ┌──────────┐
          │ Login │           │ Register │
          └───┬───┘           └─────┬────┘
              │                     │
              └──────────┬──────────┘
                         ▼
    ┌─────────────────────────────────────────────┐
    │           Bottom Nav (авторизован)          │
    ├─────────────┬─────────────┬─────────────────┤
    │   Группы    │   Профиль   │     Админ       │
    │   /groups   │   /profile  │    /admin       │
    └──────┬──────┴──────┬──────┴───────┬─────────┘
           │             │              │
           ▼             ▼              ▼
    ┌─────────────┐ ┌─────────┐  ┌────────────┐
    │ Groups List │ │ Profile │  │   Admin    │
    └──────┬──────┘ └────┬────┘  └──────┬─────┘
           │             │              │
    ┌──────┴──────┐      │       ┌──────┴──────┐
    ▼             ▼      ▼       ▼      ▼      ▼
┌───────┐   ┌─────────┐ ────  Users  Movies Groups
│ Create│   │ Group   │
└───────┘   │ [id]    │
            └────┬────┘
                 │
        ┌────────┼────────┐
        ▼        ▼        ▼
    ┌───────┐ ┌────────┐
    │ Search│ │Settings│
    └───────┘ └────────┘
```

---

## Ролевая модель

### Глобальные роли (users.role)

| Роль | Bottom Nav | Доступ |
| ---- | ---------- | ------ |
| USER | Группы, Профиль | Публичные + свой контент |
| ADMIN | Группы, Профиль, Админ | Всё + Admin Panel |

### Роли в группе (group_members.role)

| Роль | Просмотр | Добавление фильмов | Управление участниками | Удаление группы |
| ---- | :------: | :----------------: | :--------------------: | :-------------: |
| member | ✅ | ❌ | ❌ | ❌ |
| moderator | ✅ | ✅ | ✅ (add/remove) | ❌ |
| admin | ✅ | ✅ | ✅ (full) | ✅ |

---

## UI-паттерны (Mobile-first)

### Floating Action Button (FAB)

Используется для главного действия на экране:
- Groups List → создать группу
- Group Page → добавить фильм (moderator+)
- Admin sections → добавить сущность

**Position:** bottom-right, выше Bottom Nav (56dp от низа)

### Bottom Sheet

Используется для:
- Контекстные меню (действия над участником)
- Подтверждение удаления
- Выбор роли

### Modal (Fullscreen)

Используется для:
- Создание группы
- Поиск фильмов
- Редактирование профиля

### Empty States

Каждый список имеет empty state:
- Иллюстрация
- Заголовок
- Описание
- CTA кнопка (если применимо)

### Loading States

- Skeleton loaders для списков
- Spinner для одиночных операций
- Optimistic UI для likes/действий

---

## Статусы фильмов

| Статус | Label | Badge | Описание |
| ------ | ----- | ----- | -------- |
| tracking | К просмотру | серый | В списке, без конкретной даты |
| planned | План | синий | Запланирован с датой |
| watched | Смотрели | зелёный | Просмотрен |

---

## Future Features

- `/forgot-password` — восстановление пароля
- `/groups/[id]/invite` — пригласительные ссылки
- `/groups/[id]/movies/[movieId]` — детали фильма
- `/groups/[id]/movies/[movieId]/reviews` — отзывы и оценки
- Push-уведомления
- Dark mode
